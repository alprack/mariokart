---
title: "finalProjAboutMarioKart"
author: "Rowan Ess, Anna Prack"
date: "2025-04-22"
output: html_document
editor_options: 
  markdown: 
    wrap: sentence
---

```{r, warning=FALSE,message=FALSE}
library(tidyverse)
library(openintro)
library(ggplot2)
library(dplyr)
```

## Data Introduction

This paper will be utilizing the mariokart data set from openintro.\
This data set was collected by recording the auction data from 143 listings for Mario Kart for the Nintendo Wii.\
This data was collected in October 2009.\
This data set has 12 variables, however we will be focusing on three, the final sale price, the shipping price, and the number of wheels included.\

```{r}
mariokart
```

### Variables

total_pr: total price (numerical)\
ship_pr: shipping price (numerical)\
wheels: numbers of wheels included (numerical)\

## Research Questions:

Question: How does the quantity of wheels affect the auction price for a Mario Kart Wii game?\
Null: The quantity of wheels does not affect the auction price.\
Alternative: The quantity of wheels affects the auction price.\

### Errors

Type 1: We conclude that the price changes based on the wheels, even though it does not.\
Type 2: We conclude that the price does not change based on the wheels, even though it did.\
Type 1 would be worse, because the conclusion it draws could be construed as actionable information, leading to a greater consequence.\

### Supporting Questions

How independent is the number of wheels as a variable?\
How to other variables effect the auction price?\
How does the number of wheel effect the shipping price?\

### Expectations

We expect that increasing the number of wheels will increase the auction price.\

## Main Analyses:

The primary purpose of this assessment is to find what effect the quantity of steering wheels has on the sale price of all Mario Kart Wii Games. This requires finding the actual price of the auctioned goods.\

As the data set does not provide ending auction price as its own variable, we must subtract shipping price from the total price\

Once we have the sale price, then we can begin to find the relationship between the two.\

To create a scatterplot, which is necessary to show correlation, we need to first clean the data, by eliminating extreme outliers, of which there are one or two. The most extreme outlier is a listing that also includes a Wii console, so we are attempting to eliminate external factors. \

In addition we are restraining the data to be within a certain range, so that no strange data affects the result.\

```{r}

# Compute IQR boundaries
q1 <- quantile(mariokart$total_pr, 0.25)
q3 <- quantile(mariokart$total_pr, 0.75)
iqr <- q3 - q1

# Define outlier bounds
lower_bound <- q1 - 1.5 * iqr
upper_bound <- q3 + 1.5 * iqr

# Filter out outliers
mariokart_clean <- mariokart %>%
  filter(total_pr >= lower_bound & total_pr <= upper_bound)

mariokart_clean <- mariokart_clean %>%
  mutate (auction_pr = total_pr - ship_pr)

```

After all of that, we can finally generate the scatterplot. \

```{r}
ggplot(mariokart_clean, aes(x = wheels, y = (auction_pr))) +
  geom_point(width = 0.1, alpha = 0.6, color = "blue") +
  geom_smooth(method = "lm", se = TRUE, color = "red") +
  scale_x_continuous(breaks = c(0, 1, 2, 3, 4, 5), labels = c(0, 1, 2, 3, 4, 5)) +
  labs(
    title = "Auction Price by Wheel Accessory (Outliers Removed)",
    x = "Wheel Accessory Included",
    y = "Auction Price Paid (USD)"
  ) +
  theme_minimal()


```

```{r}
cor(x = mariokart_clean$wheels, y = (mariokart_clean$auction_pr))
```

To describe our line of best fit, which should show the which should further show this relation, we need to create a linear model. This will provide a large amount of data about this line and how accurate it is. The line minimizes the squares of all residuals.\

```{r}
mariokartlm <- lm(auction_pr ~ wheels, data = mariokart_clean) # Regress y on x, or symbolically, y ~ x
lm_summary <- summary(mariokartlm)
lm_summary
```
```{r}
mariokartlm$coefficients
intercept <- mariokartlm$coefficients["(Intercept)"]
slope <- mariokartlm$coefficients["wheels"] 
```

With this data, we can graph the residuals to further show the effectiveness of the relationship line. These residuals, when squared and summed, create the Residual of Squared Sums, which can be further used to calculate the Mean Squared Error. Minimizing these two is, in effect, creating the best fit line. \

```{r}
plot(mariokartlm,1)
```

```{r}
(RSS <- sum(mariokartlm$residuals^2))
```

```{r}
(MSE <- RSS/nrow(mariokart_clean))
```

Because the RSS and MSE are relatively low (the MSE being 34 meaning that, on average, the actual value is less than 6 units away from the predicted), this demonstrates that this line is a good fit for this scatterplot. \

In addition, this means that, because the scatterplot is related to the line, and the line is positive and linear, the scatterplot, or our data, has a positive, linear relationship.\






